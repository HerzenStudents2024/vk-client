{"ast":null,"code":"import { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport { _ as _object_spread_props } from \"@swc/helpers/_/_object_spread_props\";\nimport { _ as _object_without_properties } from \"@swc/helpers/_/_object_without_properties\";\nimport { _ as _sliced_to_array } from \"@swc/helpers/_/_sliced_to_array\";\nimport * as React from \"react\";\nimport { clamp } from \"../../helpers/math\";\nimport { useTimeout } from \"../../hooks/useTimeout\";\nimport { BaseGallery } from \"../BaseGallery/BaseGallery\";\n/**\n * @see https://vkcom.github.io/VKUI/#/Gallery\n */\nexport var Gallery = function (_param) {\n  var _param_initialSlideIndex = _param.initialSlideIndex,\n    initialSlideIndex = _param_initialSlideIndex === void 0 ? 0 : _param_initialSlideIndex,\n    children = _param.children,\n    _param_timeout = _param.timeout,\n    timeout = _param_timeout === void 0 ? 0 : _param_timeout,\n    onChange = _param.onChange,\n    bullets = _param.bullets,\n    props = _object_without_properties(_param, [\"initialSlideIndex\", \"children\", \"timeout\", \"onChange\", \"bullets\"]);\n  var _React_useState = _sliced_to_array(React.useState(initialSlideIndex), 2),\n    localSlideIndex = _React_useState[0],\n    setSlideIndex = _React_useState[1];\n  var isControlled = typeof props.slideIndex === \"number\";\n  var _props_slideIndex;\n  var slideIndex = isControlled ? (_props_slideIndex = props.slideIndex) !== null && _props_slideIndex !== void 0 ? _props_slideIndex : 0 : localSlideIndex;\n  var isDraggable = !isControlled || Boolean(onChange);\n  var slides = React.useMemo(function () {\n    return React.Children.toArray(children).filter(function (item) {\n      return Boolean(item);\n    });\n  }, [children]);\n  var childCount = slides.length;\n  var handleChange = React.useCallback(function (current) {\n    if (current === slideIndex) {\n      return;\n    }\n    !isControlled && setSlideIndex(current);\n    onChange && onChange(current);\n  }, [isControlled, onChange, slideIndex]);\n  var autoplay = useTimeout(function () {\n    return handleChange((slideIndex + 1) % childCount);\n  }, timeout);\n  React.useEffect(function () {\n    return timeout ? autoplay.set() : autoplay.clear();\n  }, [timeout, slideIndex, autoplay]);\n  // prevent invalid slideIndex\n  // any slide index is invalid with no slides, just keep it as is\n  var safeSlideIndex = childCount > 0 ? clamp(slideIndex, 0, childCount - 1) : slideIndex;\n  // notify parent in controlled mode\n  React.useEffect(function () {\n    if (onChange && safeSlideIndex !== slideIndex) {\n      onChange(safeSlideIndex);\n    }\n    setSlideIndex(safeSlideIndex);\n  }, [onChange, safeSlideIndex, slideIndex]);\n  return /*#__PURE__*/React.createElement(BaseGallery, _object_spread_props(_object_spread({\n    isDraggable: isDraggable\n  }, props), {\n    bullets: childCount > 0 && bullets,\n    slideIndex: safeSlideIndex,\n    onChange: handleChange\n  }), slides);\n};","map":{"version":3,"names":["React","clamp","useTimeout","BaseGallery","Gallery","_param","initialSlideIndex","_param_initialSlideIndex","children","_param_timeout","timeout","onChange","bullets","props","_object_without_properties","_React_useState","_sliced_to_array","useState","localSlideIndex","setSlideIndex","isControlled","slideIndex","_props_slideIndex","isDraggable","Boolean","slides","useMemo","Children","toArray","filter","item","childCount","length","handleChange","useCallback","current","autoplay","useEffect","set","clear","safeSlideIndex","createElement","_object_spread_props","_object_spread"],"sources":["/Users/evgeny/Desktop/VsCodeProjects/vk-client/vk-client/node_modules/@vkontakte/vkui/src/components/Gallery/Gallery.tsx"],"sourcesContent":["import * as React from 'react';\nimport { clamp } from '../../helpers/math';\nimport { useTimeout } from '../../hooks/useTimeout';\nimport { BaseGallery } from '../BaseGallery/BaseGallery';\nimport { BaseGalleryProps } from '../BaseGallery/types';\n\nexport interface GalleryProps extends BaseGalleryProps {\n  initialSlideIndex?: number;\n  timeout?: number;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/Gallery\n */\nexport const Gallery = ({\n  initialSlideIndex = 0,\n  children,\n  timeout = 0,\n  onChange,\n  bullets,\n  ...props\n}: GalleryProps) => {\n  const [localSlideIndex, setSlideIndex] = React.useState(initialSlideIndex);\n  const isControlled = typeof props.slideIndex === 'number';\n  const slideIndex = isControlled ? props.slideIndex ?? 0 : localSlideIndex;\n  const isDraggable = !isControlled || Boolean(onChange);\n  const slides = React.useMemo(\n    () => React.Children.toArray(children).filter((item) => Boolean(item)),\n    [children],\n  );\n  const childCount = slides.length;\n\n  const handleChange: GalleryProps['onChange'] = React.useCallback(\n    (current: number) => {\n      if (current === slideIndex) {\n        return;\n      }\n      !isControlled && setSlideIndex(current);\n      onChange && onChange(current);\n    },\n    [isControlled, onChange, slideIndex],\n  );\n\n  const autoplay = useTimeout(() => handleChange((slideIndex + 1) % childCount), timeout);\n  React.useEffect(\n    () => (timeout ? autoplay.set() : autoplay.clear()),\n    [timeout, slideIndex, autoplay],\n  );\n\n  // prevent invalid slideIndex\n  // any slide index is invalid with no slides, just keep it as is\n  const safeSlideIndex = childCount > 0 ? clamp(slideIndex, 0, childCount - 1) : slideIndex;\n  // notify parent in controlled mode\n  React.useEffect(() => {\n    if (onChange && safeSlideIndex !== slideIndex) {\n      onChange(safeSlideIndex);\n    }\n    setSlideIndex(safeSlideIndex);\n  }, [onChange, safeSlideIndex, slideIndex]);\n\n  return (\n    <BaseGallery\n      isDraggable={isDraggable}\n      {...props}\n      bullets={childCount > 0 && bullets}\n      slideIndex={safeSlideIndex}\n      onChange={handleChange}\n    >\n      {slides}\n    </BaseGallery>\n  );\n};\n"],"mappings":";;;;AAAA,YAAYA,KAAA,MAAW;AACvB,SAASC,KAAK,QAAQ;AACtB,SAASC,UAAU,QAAQ;AAC3B,SAASC,WAAW,QAAQ;AAQ5B;;;AAGA,OAAO,IAAMC,OAAA,GAAU,SAAAA,CAAAC,MAAA;wCACrBC,iBAAA;IAAAA,iBAAA,GAAAC,wBAAA,cAAoB,IAAAA,wBAAA;IACpBC,QAAA,GAAAH,MAAA,CAAAG,QAAA;IAAAC,cAAA,GAAAJ,MAAA,CACAK,OAAA;IAAAA,OAAA,GAAAD,cAAA,cAAU,IAAAA,cAAA;IACVE,QAAA,GAAAN,MAAA,CAAAM,QAAA;IACAC,OAAA,GAAAP,MAAA,CAAAO,OAAA;IACGC,KAAA,GAAAC,0BAAA,CAAAT,MAAA,GALH,qBACA,YACA,WACA,YACA,U;EAGA,IAAyCU,eAAA,GAAAC,gBAAA,CAAAhB,KAAA,CAAMiB,QAAQ,CAACX,iBAAA;IAAjDY,eAAA,GAAkCH,eAAA;IAAjBI,aAAA,GAAiBJ,eAAA;EACzC,IAAMK,YAAA,GAAe,OAAOP,KAAA,CAAMQ,UAAU,KAAK;MACfC,iBAAA;EAAlC,IAAMD,UAAA,GAAaD,YAAA,GAAe,CAAAE,iBAAA,GAAAT,KAAA,CAAMQ,UAAU,cAAhBC,iBAAA,cAAAA,iBAAA,GAAoB,IAAIJ,eAAA;EAC1D,IAAMK,WAAA,GAAc,CAACH,YAAA,IAAgBI,OAAA,CAAQb,QAAA;EAC7C,IAAMc,MAAA,GAASzB,KAAA,CAAM0B,OAAO,CAC1B;WAAM1B,KAAA,CAAM2B,QAAQ,CAACC,OAAO,CAACpB,QAAA,EAAUqB,MAAM,CAAC,UAACC,IAAA;aAASN,OAAA,CAAQM,IAAA;;KAChE,CAACtB,QAAA,CAAS;EAEZ,IAAMuB,UAAA,GAAaN,MAAA,CAAOO,MAAM;EAEhC,IAAMC,YAAA,GAAyCjC,KAAA,CAAMkC,WAAW,CAC9D,UAACC,OAAA;IACC,IAAIA,OAAA,KAAYd,UAAA,EAAY;MAC1B;IACF;IACA,CAACD,YAAA,IAAgBD,aAAA,CAAcgB,OAAA;IAC/BxB,QAAA,IAAYA,QAAA,CAASwB,OAAA;EACvB,GACA,CAACf,YAAA,EAAcT,QAAA,EAAUU,UAAA,CAAW;EAGtC,IAAMe,QAAA,GAAWlC,UAAA,CAAW;WAAM+B,YAAA,CAAa,CAACZ,UAAA,GAAa,KAAKU,UAAA;KAAarB,OAAA;EAC/EV,KAAA,CAAMqC,SAAS,CACb;WAAO3B,OAAA,GAAU0B,QAAA,CAASE,GAAG,KAAKF,QAAA,CAASG,KAAK;KAChD,CAAC7B,OAAA,EAASW,UAAA,EAAYe,QAAA,CAAS;EAGjC;EACA;EACA,IAAMI,cAAA,GAAiBT,UAAA,GAAa,IAAI9B,KAAA,CAAMoB,UAAA,EAAY,GAAGU,UAAA,GAAa,KAAKV,UAAA;EAC/E;EACArB,KAAA,CAAMqC,SAAS,CAAC;IACd,IAAI1B,QAAA,IAAY6B,cAAA,KAAmBnB,UAAA,EAAY;MAC7CV,QAAA,CAAS6B,cAAA;IACX;IACArB,aAAA,CAAcqB,cAAA;EAChB,GAAG,CAAC7B,QAAA,EAAU6B,cAAA,EAAgBnB,UAAA,CAAW;EAEzC,oBACErB,KAAA,CAAAyC,aAAA,CAACtC,WAAA,EAAAuC,oBAAA,CAAAC,cAAA;IACCpB,WAAA,EAAaA;KACTV,KAAA;IACJD,OAAA,EAASmB,UAAA,GAAa,KAAKnB,OAAA;IAC3BS,UAAA,EAAYmB,cAAA;IACZ7B,QAAA,EAAUsB;MAETR,MAAA;AAGP"},"metadata":{},"sourceType":"module","externalDependencies":[]}