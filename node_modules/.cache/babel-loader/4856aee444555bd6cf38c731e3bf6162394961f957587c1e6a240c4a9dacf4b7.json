{"ast":null,"code":"import { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport { _ as _object_spread_props } from \"@swc/helpers/_/_object_spread_props\";\nimport { _ as _object_without_properties } from \"@swc/helpers/_/_object_without_properties\";\nimport { _ as _sliced_to_array } from \"@swc/helpers/_/_sliced_to_array\";\nimport * as React from \"react\";\nimport { classNames } from \"@vkontakte/vkjs\";\nimport { useAdaptivityHasPointer } from \"../../hooks/useAdaptivityHasPointer\";\nimport { useExternRef } from \"../../hooks/useExternRef\";\nimport { useGlobalEventListener } from \"../../hooks/useGlobalEventListener\";\nimport { useDOM } from \"../../lib/dom\";\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nimport { ScrollArrow } from \"../ScrollArrow/ScrollArrow\";\nimport { Touch } from \"../Touch/Touch\";\nimport { calcMax, calcMin } from \"./helpers\";\nvar ANIMATION_DURATION = 0.24;\nvar LAYOUT_DEFAULT_STATE = {\n  containerWidth: 0,\n  viewportOffsetWidth: 0,\n  layerWidth: 0,\n  min: 0,\n  max: 0,\n  slides: [],\n  isFullyVisible: true\n};\nvar SHIFT_DEFAULT_STATE = {\n  animation: undefined,\n  shiftX: 0,\n  dragging: false,\n  deltaX: 0,\n  indent: 0\n};\nexport var BaseGallery = function (_param) {\n  var _param_bullets = _param.bullets,\n    bullets = _param_bullets === void 0 ? false : _param_bullets,\n    getRootRef = _param.getRootRef,\n    children = _param.children,\n    _param_slideWidth = _param.slideWidth,\n    slideWidth = _param_slideWidth === void 0 ? \"100%\" : _param_slideWidth,\n    _param_slideIndex = _param.slideIndex,\n    slideIndex = _param_slideIndex === void 0 ? 0 : _param_slideIndex,\n    tmp = _param.isDraggable,\n    isDraggableProp = tmp === void 0 ? true : tmp,\n    onDragStart = _param.onDragStart,\n    onDragEnd = _param.onDragEnd,\n    onChange = _param.onChange,\n    onPrevClick = _param.onPrevClick,\n    onNextClick = _param.onNextClick,\n    _param_align = _param.align,\n    align = _param_align === void 0 ? \"left\" : _param_align,\n    showArrows = _param.showArrows,\n    getRef = _param.getRef,\n    className = _param.className,\n    _param_arrowSize = _param.arrowSize,\n    arrowSize = _param_arrowSize === void 0 ? \"l\" : _param_arrowSize,\n    restProps = _object_without_properties(_param, [\"bullets\", \"getRootRef\", \"children\", \"slideWidth\", \"slideIndex\", \"isDraggable\", \"onDragStart\", \"onDragEnd\", \"onChange\", \"onPrevClick\", \"onNextClick\", \"align\", \"showArrows\", \"getRef\", \"className\", \"arrowSize\"]);\n  var slidesStore = React.useRef({});\n  var layoutState = React.useRef(LAYOUT_DEFAULT_STATE);\n  var _React_useState = _sliced_to_array(React.useState(SHIFT_DEFAULT_STATE), 2),\n    shiftState = _React_useState[0],\n    setShiftState = _React_useState[1];\n  var rootRef = useExternRef(getRootRef);\n  var viewportRef = useExternRef(getRef);\n  var window = useDOM().window;\n  var hasPointer = useAdaptivityHasPointer();\n  var isCenterWithCustomWidth = slideWidth === \"custom\" && align === \"center\";\n  var validateIndent = function (value) {\n    var _layoutState_current_max;\n    var localMax = (_layoutState_current_max = layoutState.current.max) !== null && _layoutState_current_max !== void 0 ? _layoutState_current_max : 0;\n    var _layoutState_current_min;\n    var localMin = (_layoutState_current_min = layoutState.current.min) !== null && _layoutState_current_min !== void 0 ? _layoutState_current_min : 0;\n    if (value < localMin) {\n      return localMin;\n    } else if (value > localMax) {\n      return localMax;\n    }\n    return value;\n  };\n  /*\n  * Считает отступ слоя галереи\n  */\n  var calculateIndent = function (targetIndex) {\n    var _layoutState_current_slides;\n    if (layoutState.current.isFullyVisible) {\n      return 0;\n    }\n    var targetSlide = ((_layoutState_current_slides = layoutState.current.slides) === null || _layoutState_current_slides === void 0 ? void 0 : _layoutState_current_slides.length) ? layoutState.current.slides[targetIndex] : null;\n    if (targetSlide) {\n      var coordX = targetSlide.coordX,\n        width = targetSlide.width;\n      if (isCenterWithCustomWidth) {\n        var _layoutState_current_viewportOffsetWidth;\n        var viewportWidth = (_layoutState_current_viewportOffsetWidth = layoutState.current.viewportOffsetWidth) !== null && _layoutState_current_viewportOffsetWidth !== void 0 ? _layoutState_current_viewportOffsetWidth : 0;\n        return viewportWidth / 2 - coordX - width / 2;\n      }\n      return validateIndent(-1 * coordX);\n    }\n    return 0;\n  };\n  /*\n  * Считает отступ слоя галереи во время драга\n  */\n  var calculateDragIndent = function () {\n    var _layoutState_current_max;\n    var localMax = (_layoutState_current_max = layoutState.current.max) !== null && _layoutState_current_max !== void 0 ? _layoutState_current_max : 0;\n    var _layoutState_current_min;\n    var localMin = (_layoutState_current_min = layoutState.current.min) !== null && _layoutState_current_min !== void 0 ? _layoutState_current_min : 0;\n    var indent = shiftState.shiftX + shiftState.deltaX;\n    if (indent > localMax) {\n      return localMax + Number((indent - localMax) / 3);\n    } else if (indent < localMin) {\n      return localMin + Number((indent - localMin) / 3);\n    }\n    return indent;\n  };\n  var initializeSlides = function () {\n    var options = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};\n    var _rootRef_current, _viewportRef_current, _layoutState_current_slides_slideIndex, _localSlides_slideIndex;\n    var _React_Children_map;\n    var localSlides = (_React_Children_map = React.Children.map(children, function (_item, i) {\n      var _elem, _elem1;\n      var elem = slidesStore.current[\"slide-\".concat(i)];\n      var _elem_offsetLeft, _elem_offsetWidth;\n      return {\n        coordX: (_elem_offsetLeft = (_elem = elem) === null || _elem === void 0 ? void 0 : _elem.offsetLeft) !== null && _elem_offsetLeft !== void 0 ? _elem_offsetLeft : 0,\n        width: (_elem_offsetWidth = (_elem1 = elem) === null || _elem1 === void 0 ? void 0 : _elem1.offsetWidth) !== null && _elem_offsetWidth !== void 0 ? _elem_offsetWidth : 0\n      };\n    })) !== null && _React_Children_map !== void 0 ? _React_Children_map : [];\n    var _rootRef_current_offsetWidth;\n    var localContainerWidth = (_rootRef_current_offsetWidth = (_rootRef_current = rootRef.current) === null || _rootRef_current === void 0 ? void 0 : _rootRef_current.offsetWidth) !== null && _rootRef_current_offsetWidth !== void 0 ? _rootRef_current_offsetWidth : 0;\n    var _viewportRef_current_offsetWidth;\n    var localViewportOffsetWidth = (_viewportRef_current_offsetWidth = (_viewportRef_current = viewportRef.current) === null || _viewportRef_current === void 0 ? void 0 : _viewportRef_current.offsetWidth) !== null && _viewportRef_current_offsetWidth !== void 0 ? _viewportRef_current_offsetWidth : 0;\n    var localLayerWidth = localSlides.reduce(function (val, slide) {\n      return slide.width + val;\n    }, 0);\n    var adjustShiftX = localSlides.length <= layoutState.current.slides.length || ((_layoutState_current_slides_slideIndex = layoutState.current.slides[slideIndex]) === null || _layoutState_current_slides_slideIndex === void 0 ? void 0 : _layoutState_current_slides_slideIndex.coordX) !== ((_localSlides_slideIndex = localSlides[slideIndex]) === null || _localSlides_slideIndex === void 0 ? void 0 : _localSlides_slideIndex.coordX);\n    layoutState.current = {\n      containerWidth: localContainerWidth,\n      viewportOffsetWidth: localViewportOffsetWidth,\n      layerWidth: localLayerWidth,\n      max: calcMax({\n        slides: localSlides,\n        viewportOffsetWidth: localViewportOffsetWidth,\n        isCenterWithCustomWidth: isCenterWithCustomWidth\n      }),\n      min: calcMin({\n        containerWidth: localContainerWidth,\n        layerWidth: localLayerWidth,\n        slides: localSlides,\n        viewportOffsetWidth: localViewportOffsetWidth,\n        isCenterWithCustomWidth: isCenterWithCustomWidth,\n        align: align\n      }),\n      slides: localSlides,\n      isFullyVisible: localLayerWidth <= localContainerWidth\n    };\n    var _options_animation;\n    setShiftState(function (prevState) {\n      return _object_spread_props(_object_spread({}, prevState), {\n        shiftX: adjustShiftX ? calculateIndent(slideIndex) : prevState.shiftX,\n        animation: (_options_animation = options.animation) !== null && _options_animation !== void 0 ? _options_animation : prevState.shiftX === validateIndent(prevState.shiftX)\n      });\n    });\n  };\n  var onResize = function () {\n    if (shiftState.animation !== undefined) {\n      initializeSlides({\n        animation: false\n      });\n    }\n  };\n  useGlobalEventListener(window, \"resize\", onResize);\n  useIsomorphicLayoutEffect(function () {\n    initializeSlides({\n      animation: false\n    });\n  }, [children, align, slideWidth]);\n  useIsomorphicLayoutEffect(function () {\n    if (shiftState.animation !== undefined) {\n      setShiftState(function (prevState) {\n        return _object_spread_props(_object_spread({}, prevState), {\n          animation: true,\n          deltaX: 0,\n          shiftX: calculateIndent(slideIndex !== null && slideIndex !== void 0 ? slideIndex : 0)\n        });\n      });\n    }\n  }, [slideIndex]);\n  var slideLeft = function (event) {\n    var _onChange, _onPrevClick;\n    (_onChange = onChange) === null || _onChange === void 0 ? void 0 : _onChange(slideIndex - 1);\n    (_onPrevClick = onPrevClick) === null || _onPrevClick === void 0 ? void 0 : _onPrevClick(event);\n  };\n  var slideRight = function (event) {\n    var _onChange, _onNextClick;\n    (_onChange = onChange) === null || _onChange === void 0 ? void 0 : _onChange(slideIndex + 1);\n    (_onNextClick = onNextClick) === null || _onNextClick === void 0 ? void 0 : _onNextClick(event);\n  };\n  /*\n  * Получает индекс слайда, к которому будет осуществлен переход\n  */\n  var getTarget = function (e) {\n    var expectDeltaX = shiftState.deltaX / e.duration * 240 * 0.6;\n    var _layoutState_current_max;\n    var shift = shiftState.shiftX + shiftState.deltaX + expectDeltaX - ((_layoutState_current_max = layoutState.current.max) !== null && _layoutState_current_max !== void 0 ? _layoutState_current_max : 0);\n    var direction = shiftState.deltaX < 0 ? 1 : -1;\n    // Находим ближайшую границу слайда к текущему отступу\n    var targetIndex = layoutState.current.slides.reduce(function (val, item, index) {\n      var previousValue = Math.abs(layoutState.current.slides[val].coordX + shift);\n      var currentValue = Math.abs(item.coordX + shift);\n      return previousValue < currentValue ? val : index;\n    }, slideIndex);\n    if (targetIndex === slideIndex) {\n      var targetSlide = slideIndex + direction;\n      if (targetSlide >= 0 && targetSlide < layoutState.current.slides.length) {\n        if (Math.abs(shiftState.deltaX) > layoutState.current.slides[targetSlide].width * 0.05) {\n          targetIndex = targetSlide;\n        }\n      }\n    }\n    return targetIndex;\n  };\n  var onStart = function (e) {\n    var _onDragStart;\n    (_onDragStart = onDragStart) === null || _onDragStart === void 0 ? void 0 : _onDragStart(e);\n    setShiftState(function (prevState) {\n      return _object_spread_props(_object_spread({}, prevState), {\n        animation: false\n      });\n    });\n  };\n  var onMoveX = function (e) {\n    if (isDraggableProp && !layoutState.current.isFullyVisible) {\n      e.originalEvent.preventDefault();\n      if (e.isSlideX) {\n        if (shiftState.deltaX !== e.shiftX) {\n          setShiftState(function (prevState) {\n            return _object_spread_props(_object_spread({}, prevState), {\n              deltaX: e.shiftX,\n              dragging: e.isSlideX\n            });\n          });\n        }\n      }\n    }\n  };\n  var onEnd = function (e) {\n    var _onDragEnd;\n    var targetIndex = e.isSlide ? getTarget(e) : slideIndex !== null && slideIndex !== void 0 ? slideIndex : 0;\n    (_onDragEnd = onDragEnd) === null || _onDragEnd === void 0 ? void 0 : _onDragEnd(e, targetIndex);\n    var nextShiftState = {\n      animation: true,\n      dragging: false,\n      deltaX: 0\n    };\n    var shiftXStick = calculateDragIndent();\n    if (targetIndex !== slideIndex) {\n      // Сохраняем сдвиг слайда в том положении, в каком его оставили после драга (fix issue #2185)\n      nextShiftState.shiftX = shiftXStick;\n    }\n    setShiftState(function (prevState) {\n      return _object_spread({}, prevState, nextShiftState);\n    });\n    if (targetIndex !== slideIndex) {\n      var _onChange;\n      (_onChange = onChange) === null || _onChange === void 0 ? void 0 : _onChange(targetIndex);\n    }\n  };\n  var indent = shiftState.dragging ? calculateDragIndent() : shiftState.shiftX;\n  var layerStyle = {\n    WebkitTransform: \"translateX(\".concat(indent, \"px)\"),\n    transform: \"translateX(\".concat(indent, \"px)\"),\n    WebkitTransition: shiftState.animation ? \"-webkit-transform \".concat(ANIMATION_DURATION, \"s cubic-bezier(.1, 0, .25, 1)\") : \"none\",\n    transition: shiftState.animation ? \"transform \".concat(ANIMATION_DURATION, \"s cubic-bezier(.1, 0, .25, 1)\") : \"none\"\n  };\n  var setSlideRef = function (slideRef, slideIndex) {\n    slidesStore.current[\"slide-\".concat(slideIndex)] = slideRef;\n  };\n  // shiftX is negative number <= 0, we can swipe back only if it is < 0\n  var canSlideLeft = !layoutState.current.isFullyVisible && shiftState.shiftX < 0;\n  var _layoutState_current_layerWidth;\n  var canSlideRight = !layoutState.current.isFullyVisible && (\n  // we can't move right when gallery layer fully scrolled right, if gallery aligned by left side\n  align === \"left\" && layoutState.current.containerWidth - shiftState.shiftX < ((_layoutState_current_layerWidth = layoutState.current.layerWidth) !== null && _layoutState_current_layerWidth !== void 0 ? _layoutState_current_layerWidth : 0) ||\n  // otherwise we need to check current slide index (align = right or align = center)\n  align !== \"left\" && slideIndex < layoutState.current.slides.length - 1);\n  var isDraggable = isDraggableProp && !layoutState.current.isFullyVisible;\n  return /*#__PURE__*/React.createElement(\"div\", _object_spread_props(_object_spread({}, restProps), {\n    className: classNames(\"vkuiBaseGallery\", align === \"center\" && \"vkuiBaseGallery--align-center\", slideWidth === \"custom\" && \"vkuiBaseGallery--custom-width\", isDraggable && \"vkuiBaseGallery--draggable\", className),\n    ref: rootRef\n  }), /*#__PURE__*/React.createElement(Touch, {\n    className: \"vkuiBaseGallery__viewport\",\n    onStartX: onStart,\n    onMoveX: onMoveX,\n    onEnd: onEnd,\n    style: {\n      width: slideWidth === \"custom\" ? \"100%\" : slideWidth\n    },\n    getRootRef: viewportRef,\n    noSlideClick: true\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiBaseGallery__layer\",\n    style: layerStyle\n  }, React.Children.map(children, function (item, i) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"vkuiBaseGallery__slide\",\n      key: \"slide-\".concat(i),\n      ref: function (el) {\n        return setSlideRef(el, i);\n      }\n    }, item);\n  }))), bullets && /*#__PURE__*/React.createElement(\"div\", {\n    \"aria-hidden\": true,\n    className: classNames(\"vkuiBaseGallery__bullets\", {\n      dark: \"vkuiBaseGallery__bullets--dark\",\n      light: \"vkuiBaseGallery__bullets--light\"\n    }[bullets])\n  }, React.Children.map(children, function (_item, index) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classNames(\"vkuiBaseGallery__bullet\", index === slideIndex && \"vkuiBaseGallery__bullet--active\"),\n      key: index\n    });\n  })), showArrows && hasPointer && canSlideLeft && /*#__PURE__*/React.createElement(ScrollArrow, {\n    className: \"vkuiBaseGallery__arrow\",\n    direction: \"left\",\n    onClick: slideLeft,\n    size: arrowSize\n  }), showArrows && hasPointer && canSlideRight && /*#__PURE__*/React.createElement(ScrollArrow, {\n    className: \"vkuiBaseGallery__arrow\",\n    direction: \"right\",\n    onClick: slideRight,\n    size: arrowSize\n  }));\n};","map":{"version":3,"names":["React","classNames","useAdaptivityHasPointer","useExternRef","useGlobalEventListener","useDOM","useIsomorphicLayoutEffect","ScrollArrow","Touch","calcMax","calcMin","ANIMATION_DURATION","LAYOUT_DEFAULT_STATE","containerWidth","viewportOffsetWidth","layerWidth","min","max","slides","isFullyVisible","SHIFT_DEFAULT_STATE","animation","undefined","shiftX","dragging","deltaX","indent","BaseGallery","_param","bullets","_param_bullets","getRootRef","children","_param_slideWidth","slideWidth","_param_slideIndex","slideIndex","tmp","isDraggable","isDraggableProp","onDragStart","onDragEnd","onChange","onPrevClick","onNextClick","_param_align","align","showArrows","getRef","className","_param_arrowSize","arrowSize","restProps","_object_without_properties","slidesStore","useRef","layoutState","_React_useState","_sliced_to_array","useState","shiftState","setShiftState","rootRef","viewportRef","window","hasPointer","isCenterWithCustomWidth","validateIndent","value","_layoutState_current_max","localMax","current","_layoutState_current_min","localMin","calculateIndent","targetIndex","_layoutState_current_slides","targetSlide","length","coordX","width","_layoutState_current_viewportOffsetWidth","viewportWidth","calculateDragIndent","Number","initializeSlides","options","arguments","_rootRef_current","_viewportRef_current","_layoutState_current_slides_slideIndex","_localSlides_slideIndex","_React_Children_map","localSlides","Children","map","_item","i","_elem","_elem1","elem","concat","_elem_offsetLeft","_elem_offsetWidth","offsetLeft","offsetWidth","_rootRef_current_offsetWidth","localContainerWidth","_viewportRef_current_offsetWidth","localViewportOffsetWidth","localLayerWidth","reduce","val","slide","adjustShiftX","_options_animation","prevState","_object_spread_props","_object_spread","onResize","slideLeft","event","_onChange","_onPrevClick","slideRight","_onNextClick","getTarget","e","expectDeltaX","duration","shift","direction","item","index","previousValue","Math","abs","currentValue","onStart","_onDragStart","onMoveX","originalEvent","preventDefault","isSlideX","onEnd","_onDragEnd","isSlide","nextShiftState","shiftXStick","layerStyle","WebkitTransform","transform","WebkitTransition","transition","setSlideRef","slideRef","canSlideLeft","_layoutState_current_layerWidth","canSlideRight","createElement","ref","onStartX","style","noSlideClick","key","el","dark","light","onClick","size"],"sources":["/Users/evgeny/Desktop/VsCodeProjects/vk-client/vk-client/node_modules/@vkontakte/vkui/src/components/BaseGallery/BaseGallery.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useAdaptivityHasPointer } from '../../hooks/useAdaptivityHasPointer';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { useGlobalEventListener } from '../../hooks/useGlobalEventListener';\nimport { useDOM } from '../../lib/dom';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { ScrollArrow } from '../ScrollArrow/ScrollArrow';\nimport { Touch, TouchEvent } from '../Touch/Touch';\nimport { calcMax, calcMin } from './helpers';\nimport { BaseGalleryProps, GallerySlidesState, LayoutState, ShiftingState } from './types';\nimport styles from './BaseGallery.module.css';\n\nconst ANIMATION_DURATION = 0.24;\n\nconst LAYOUT_DEFAULT_STATE = {\n  containerWidth: 0,\n  viewportOffsetWidth: 0,\n  layerWidth: 0,\n  min: 0,\n  max: 0,\n  slides: [],\n  isFullyVisible: true,\n};\n\nconst SHIFT_DEFAULT_STATE = {\n  animation: undefined,\n  shiftX: 0,\n  dragging: false,\n  deltaX: 0,\n  indent: 0,\n};\n\nexport const BaseGallery = ({\n  bullets = false,\n  getRootRef,\n  children,\n  slideWidth = '100%',\n  slideIndex = 0,\n  isDraggable: isDraggableProp = true,\n  onDragStart,\n  onDragEnd,\n  onChange,\n  onPrevClick,\n  onNextClick,\n  align = 'left',\n  showArrows,\n  getRef,\n  className,\n  arrowSize = 'l',\n  ...restProps\n}: BaseGalleryProps) => {\n  const slidesStore = React.useRef<Record<string, HTMLDivElement | null>>({});\n  const layoutState = React.useRef<LayoutState>(LAYOUT_DEFAULT_STATE);\n  const [shiftState, setShiftState] = React.useState<ShiftingState>(SHIFT_DEFAULT_STATE);\n\n  const rootRef = useExternRef(getRootRef);\n  const viewportRef = useExternRef(getRef);\n\n  const { window } = useDOM();\n  const hasPointer = useAdaptivityHasPointer();\n\n  const isCenterWithCustomWidth = slideWidth === 'custom' && align === 'center';\n\n  const validateIndent = (value: number) => {\n    const localMax = layoutState.current.max ?? 0;\n    const localMin = layoutState.current.min ?? 0;\n\n    if (value < localMin) {\n      return localMin;\n    } else if (value > localMax) {\n      return localMax;\n    }\n\n    return value;\n  };\n\n  /*\n   * Считает отступ слоя галереи\n   */\n  const calculateIndent = (targetIndex: number) => {\n    if (layoutState.current.isFullyVisible) {\n      return 0;\n    }\n\n    const targetSlide = layoutState.current.slides?.length\n      ? layoutState.current.slides[targetIndex]\n      : null;\n\n    if (targetSlide) {\n      const { coordX, width } = targetSlide;\n\n      if (isCenterWithCustomWidth) {\n        const viewportWidth = layoutState.current.viewportOffsetWidth ?? 0;\n        return viewportWidth / 2 - coordX - width / 2;\n      }\n\n      return validateIndent(-1 * coordX);\n    }\n\n    return 0;\n  };\n\n  /*\n   * Считает отступ слоя галереи во время драга\n   */\n  const calculateDragIndent = () => {\n    const localMax = layoutState.current.max ?? 0;\n    const localMin = layoutState.current.min ?? 0;\n    const indent = shiftState.shiftX + shiftState.deltaX;\n\n    if (indent > localMax) {\n      return localMax + Number((indent - localMax) / 3);\n    } else if (indent < localMin) {\n      return localMin + Number((indent - localMin) / 3);\n    }\n\n    return indent;\n  };\n\n  const initializeSlides = (options: { animation?: boolean } = {}) => {\n    const localSlides =\n      React.Children.map(children, (_item: React.ReactNode, i: number): GallerySlidesState => {\n        const elem = slidesStore.current[`slide-${i}`];\n        return {\n          coordX: elem?.offsetLeft ?? 0,\n          width: elem?.offsetWidth ?? 0,\n        };\n      }) ?? [];\n\n    const localContainerWidth = rootRef.current?.offsetWidth ?? 0;\n    const localViewportOffsetWidth = viewportRef.current?.offsetWidth ?? 0;\n    const localLayerWidth = localSlides.reduce(\n      (val: number, slide: GallerySlidesState) => slide.width + val,\n      0,\n    );\n    const adjustShiftX =\n      localSlides.length <= layoutState.current.slides.length ||\n      layoutState.current.slides[slideIndex]?.coordX !== localSlides[slideIndex]?.coordX;\n\n    layoutState.current = {\n      containerWidth: localContainerWidth,\n      viewportOffsetWidth: localViewportOffsetWidth,\n      layerWidth: localLayerWidth,\n      max: calcMax({\n        slides: localSlides,\n        viewportOffsetWidth: localViewportOffsetWidth,\n        isCenterWithCustomWidth,\n      }),\n      min: calcMin({\n        containerWidth: localContainerWidth,\n        layerWidth: localLayerWidth,\n        slides: localSlides,\n        viewportOffsetWidth: localViewportOffsetWidth,\n        isCenterWithCustomWidth,\n        align,\n      }),\n      slides: localSlides,\n      isFullyVisible: localLayerWidth <= localContainerWidth,\n    };\n\n    setShiftState((prevState) => ({\n      ...prevState,\n      shiftX: adjustShiftX ? calculateIndent(slideIndex) : prevState.shiftX,\n      animation: options.animation ?? prevState.shiftX === validateIndent(prevState.shiftX),\n    }));\n  };\n\n  const onResize = () => {\n    if (shiftState.animation !== undefined) {\n      initializeSlides({ animation: false });\n    }\n  };\n\n  useGlobalEventListener(window, 'resize', onResize);\n\n  useIsomorphicLayoutEffect(() => {\n    initializeSlides({ animation: false });\n  }, [children, align, slideWidth]);\n\n  useIsomorphicLayoutEffect(() => {\n    if (shiftState.animation !== undefined) {\n      setShiftState((prevState) => ({\n        ...prevState,\n        animation: true,\n        deltaX: 0,\n        shiftX: calculateIndent(slideIndex ?? 0),\n      }));\n    }\n  }, [slideIndex]);\n\n  const slideLeft = (event: React.MouseEvent) => {\n    onChange?.(slideIndex - 1);\n    onPrevClick?.(event);\n  };\n\n  const slideRight = (event: React.MouseEvent) => {\n    onChange?.(slideIndex + 1);\n    onNextClick?.(event);\n  };\n\n  /*\n   * Получает индекс слайда, к которому будет осуществлен переход\n   */\n  const getTarget = (e: TouchEvent) => {\n    const expectDeltaX = (shiftState.deltaX / e.duration) * 240 * 0.6;\n    const shift =\n      shiftState.shiftX + shiftState.deltaX + expectDeltaX - (layoutState.current.max ?? 0);\n    const direction = shiftState.deltaX < 0 ? 1 : -1;\n\n    // Находим ближайшую границу слайда к текущему отступу\n    let targetIndex = layoutState.current.slides.reduce(\n      (val: number, item: GallerySlidesState, index: number) => {\n        const previousValue = Math.abs(layoutState.current.slides[val].coordX + shift);\n        const currentValue = Math.abs(item.coordX + shift);\n\n        return previousValue < currentValue ? val : index;\n      },\n      slideIndex,\n    );\n\n    if (targetIndex === slideIndex) {\n      let targetSlide = slideIndex + direction;\n\n      if (targetSlide >= 0 && targetSlide < layoutState.current.slides.length) {\n        if (Math.abs(shiftState.deltaX) > layoutState.current.slides[targetSlide].width * 0.05) {\n          targetIndex = targetSlide;\n        }\n      }\n    }\n\n    return targetIndex;\n  };\n\n  const onStart = (e: TouchEvent) => {\n    onDragStart?.(e);\n    setShiftState((prevState) => ({ ...prevState, animation: false }));\n  };\n\n  const onMoveX = (e: TouchEvent) => {\n    if (isDraggableProp && !layoutState.current.isFullyVisible) {\n      e.originalEvent.preventDefault();\n\n      if (e.isSlideX) {\n        if (shiftState.deltaX !== e.shiftX) {\n          setShiftState((prevState) => ({\n            ...prevState,\n            deltaX: e.shiftX,\n            dragging: e.isSlideX,\n          }));\n        }\n      }\n    }\n  };\n\n  const onEnd = (e: TouchEvent) => {\n    const targetIndex = e.isSlide ? getTarget(e) : slideIndex ?? 0;\n    onDragEnd?.(e, targetIndex);\n\n    const nextShiftState: Partial<ShiftingState> = {\n      animation: true,\n      dragging: false,\n      deltaX: 0,\n    };\n\n    const shiftXStick = calculateDragIndent();\n    if (targetIndex !== slideIndex) {\n      // Сохраняем сдвиг слайда в том положении, в каком его оставили после драга (fix issue #2185)\n      nextShiftState.shiftX = shiftXStick;\n    }\n\n    setShiftState((prevState) => ({ ...prevState, ...nextShiftState }));\n    if (targetIndex !== slideIndex) {\n      onChange?.(targetIndex);\n    }\n  };\n\n  const indent = shiftState.dragging ? calculateDragIndent() : shiftState.shiftX;\n\n  const layerStyle = {\n    WebkitTransform: `translateX(${indent}px)`,\n    transform: `translateX(${indent}px)`,\n    WebkitTransition: shiftState.animation\n      ? `-webkit-transform ${ANIMATION_DURATION}s cubic-bezier(.1, 0, .25, 1)`\n      : 'none',\n    transition: shiftState.animation\n      ? `transform ${ANIMATION_DURATION}s cubic-bezier(.1, 0, .25, 1)`\n      : 'none',\n  };\n\n  const setSlideRef = (slideRef: HTMLDivElement | null, slideIndex: number) => {\n    slidesStore.current[`slide-${slideIndex}`] = slideRef;\n  };\n\n  // shiftX is negative number <= 0, we can swipe back only if it is < 0\n  const canSlideLeft = !layoutState.current.isFullyVisible && shiftState.shiftX < 0;\n\n  const canSlideRight =\n    !layoutState.current.isFullyVisible &&\n    // we can't move right when gallery layer fully scrolled right, if gallery aligned by left side\n    ((align === 'left' &&\n      layoutState.current.containerWidth - shiftState.shiftX <\n        (layoutState.current.layerWidth ?? 0)) ||\n      // otherwise we need to check current slide index (align = right or align = center)\n      (align !== 'left' && slideIndex < layoutState.current.slides.length - 1));\n\n  const isDraggable = isDraggableProp && !layoutState.current.isFullyVisible;\n\n  return (\n    <div\n      {...restProps}\n      className={classNames(\n        styles['BaseGallery'],\n        align === 'center' && styles['BaseGallery--align-center'],\n        slideWidth === 'custom' && styles['BaseGallery--custom-width'],\n        isDraggable && styles['BaseGallery--draggable'],\n        className,\n      )}\n      ref={rootRef}\n    >\n      <Touch\n        className={styles['BaseGallery__viewport']}\n        onStartX={onStart}\n        onMoveX={onMoveX}\n        onEnd={onEnd}\n        style={{ width: slideWidth === 'custom' ? '100%' : slideWidth }}\n        getRootRef={viewportRef}\n        noSlideClick\n      >\n        <div className={styles['BaseGallery__layer']} style={layerStyle}>\n          {React.Children.map(children, (item: React.ReactNode, i: number) => (\n            <div\n              className={styles['BaseGallery__slide']}\n              key={`slide-${i}`}\n              ref={(el) => setSlideRef(el, i)}\n            >\n              {item}\n            </div>\n          ))}\n        </div>\n      </Touch>\n\n      {bullets && (\n        <div\n          aria-hidden\n          className={classNames(\n            styles['BaseGallery__bullets'],\n            {\n              dark: styles['BaseGallery__bullets--dark'],\n              light: styles['BaseGallery__bullets--light'],\n            }[bullets],\n          )}\n        >\n          {React.Children.map(children, (_item: React.ReactNode, index: number) => (\n            <div\n              className={classNames(\n                styles['BaseGallery__bullet'],\n                index === slideIndex && styles['BaseGallery__bullet--active'],\n              )}\n              key={index}\n            />\n          ))}\n        </div>\n      )}\n\n      {showArrows && hasPointer && canSlideLeft && (\n        <ScrollArrow\n          className={styles['BaseGallery__arrow']}\n          direction=\"left\"\n          onClick={slideLeft}\n          size={arrowSize}\n        />\n      )}\n      {showArrows && hasPointer && canSlideRight && (\n        <ScrollArrow\n          className={styles['BaseGallery__arrow']}\n          direction=\"right\"\n          onClick={slideRight}\n          size={arrowSize}\n        />\n      )}\n    </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}