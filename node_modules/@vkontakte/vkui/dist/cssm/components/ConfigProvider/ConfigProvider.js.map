{"version":3,"sources":["../../../../src/components/ConfigProvider/ConfigProvider.tsx"],"sourcesContent":["import * as React from 'react';\nimport { noop } from '@vkontakte/vkjs';\nimport { generateVKUITokensClassName } from '../../helpers/generateVKUITokensClassName';\nimport { useAutoDetectAppearance } from '../../hooks/useAutoDetectAppearance';\nimport { useObjectMemo } from '../../hooks/useObjectMemo';\nimport { useDOM } from '../../lib/dom';\nimport { TokensClassProvider } from '../../lib/tokensClassProvider';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport {\n  ConfigProviderContext,\n  ConfigProviderContextInterface,\n  useConfigProvider,\n} from './ConfigProviderContext';\n\nexport interface ConfigProviderProps extends Partial<ConfigProviderContextInterface> {\n  onDetectAppearanceByBridge?: () => void;\n  children: React.ReactNode;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/ConfigProvider\n */\nexport const ConfigProvider = (props: ConfigProviderProps) => {\n  const parentConfig = useConfigProvider();\n\n  const {\n    children,\n    webviewType,\n    isWebView,\n    transitionMotionEnabled,\n    platform,\n    locale,\n    appearance: appearanceProp,\n    onDetectAppearanceByBridge = noop,\n  } = {\n    ...parentConfig,\n    ...props,\n  };\n\n  const appearance = useAutoDetectAppearance(appearanceProp, onDetectAppearanceByBridge);\n\n  const { document } = useDOM();\n\n  useIsomorphicLayoutEffect(() => {\n    const VKUITokensClassName = generateVKUITokensClassName(platform, appearance);\n\n    // eslint-disable-next-line no-restricted-properties\n    document!.body.classList.add(VKUITokensClassName);\n\n    return () => {\n      // eslint-disable-next-line no-restricted-properties\n      document!.body.classList.remove(VKUITokensClassName);\n    };\n  }, [platform, appearance]);\n\n  const configContext = useObjectMemo({\n    webviewType,\n    isWebView,\n    transitionMotionEnabled,\n    platform,\n    locale,\n    appearance,\n  });\n\n  return (\n    <ConfigProviderContext.Provider value={configContext}>\n      <TokensClassProvider platform={platform} appearance={appearance}>\n        {children}\n      </TokensClassProvider>\n    </ConfigProviderContext.Provider>\n  );\n};\n"],"names":["React","noop","generateVKUITokensClassName","useAutoDetectAppearance","useObjectMemo","useDOM","TokensClassProvider","useIsomorphicLayoutEffect","ConfigProviderContext","useConfigProvider","ConfigProvider","props","parentConfig","children","webviewType","isWebView","transitionMotionEnabled","platform","locale","appearance","appearanceProp","onDetectAppearanceByBridge","document","VKUITokensClassName","body","classList","add","remove","configContext","Provider","value"],"mappings":"AAAA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,IAAI,QAAQ,kBAAkB;AACvC,SAASC,2BAA2B,QAAQ,4CAA4C;AACxF,SAASC,uBAAuB,QAAQ,sCAAsC;AAC9E,SAASC,aAAa,QAAQ,4BAA4B;AAC1D,SAASC,MAAM,QAAQ,gBAAgB;AACvC,SAASC,mBAAmB,QAAQ,gCAAgC;AACpE,SAASC,yBAAyB,QAAQ,sCAAsC;AAChF,SACEC,qBAAqB,EAErBC,iBAAiB,QACZ,0BAA0B;AAOjC;;CAEC,GACD,OAAO,MAAMC,iBAAiB,CAACC;IAC7B,MAAMC,eAAeH;IAErB,MAAM,EACJI,QAAQ,EACRC,WAAW,EACXC,SAAS,EACTC,uBAAuB,EACvBC,QAAQ,EACRC,MAAM,EACNC,YAAYC,cAAc,EAC1BC,6BAA6BpB,IAAI,EAClC,GAAG;QACF,GAAGW,YAAY;QACf,GAAGD,KAAK;IACV;IAEA,MAAMQ,aAAahB,wBAAwBiB,gBAAgBC;IAE3D,MAAM,EAAEC,QAAQ,EAAE,GAAGjB;IAErBE,0BAA0B;QACxB,MAAMgB,sBAAsBrB,4BAA4Be,UAAUE;QAElE,oDAAoD;QACpDG,SAAUE,IAAI,CAACC,SAAS,CAACC,GAAG,CAACH;QAE7B,OAAO;YACL,oDAAoD;YACpDD,SAAUE,IAAI,CAACC,SAAS,CAACE,MAAM,CAACJ;QAClC;IACF,GAAG;QAACN;QAAUE;KAAW;IAEzB,MAAMS,gBAAgBxB,cAAc;QAClCU;QACAC;QACAC;QACAC;QACAC;QACAC;IACF;IAEA,qBACE,oBAACX,sBAAsBqB,QAAQ;QAACC,OAAOF;qBACrC,oBAACtB;QAAoBW,UAAUA;QAAUE,YAAYA;OAClDN;AAIT,EAAE"}