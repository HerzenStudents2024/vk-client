{"version":3,"sources":["../../../../src/components/UsersStack/UsersStack.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames, hasReactNode } from '@vkontakte/vkjs';\nimport { useId } from '../../hooks/useId';\nimport { warnOnce } from '../../lib/warnOnce';\nimport { Caption } from '../Typography/Caption/Caption';\nimport { Footnote } from '../Typography/Footnote/Footnote';\nimport styles from './UsersStack.module.css';\n\nexport interface UsersStackProps extends React.HTMLAttributes<HTMLDivElement> {\n  /**\n   * Массив ссылок на фотографии\n   */\n  photos?: string[];\n  /**\n   * Размер аватарок\n   */\n  size?: 's' | 'm' | 'l';\n  /**\n   * Вертикальный режим рекомендуется использовать с размером `m`\n   * TODO [>=6]: удалить\n   * @deprecated\n   */\n  layout?: 'vertical' | 'horizontal';\n  /**\n   * Количество аватарок, которые будут показаны.\n   * Если в массиве `photos` больше элементов и используется размер `m`, то будет показано количество остальных элементов\n   */\n  visibleCount?: number;\n  /**\n   * Число, которое будет указано в счетчике.\n   * По умолчанию высчитывается по формуле `photos.length - visibleCount`.\n   * Если число больше 99, то счетчик скроется.\n   */\n  count?: number;\n  /**\n   * Определяет положение элементов\n   * Режим `column` рекомендуется использовать с размером `m`\n   * @since 5.3.0\n   */\n  direction?: 'row' | 'row-reverse' | 'column';\n}\n\ninterface PathElementProps extends React.SVGAttributes<SVGElement> {\n  photoSize: number;\n  direction: 'circle' | 'right' | 'left';\n}\n\ntype PhotoSizeType = 16 | 24 | 32;\n\nfunction PathElement({ photoSize, direction, ...props }: PathElementProps) {\n  switch (direction) {\n    case 'circle':\n      const radius = photoSize / 2;\n\n      return <circle cx={radius} cy={radius} r={radius} {...props} />;\n\n    case 'right':\n      switch (photoSize) {\n        case 24:\n          return (\n            <path\n              d=\"M22,18.625A12 12 0 0 1 12 24A12 12 0 0 1 12 0A12 12 0 0 1 22 5.375A12 12 0 0 0 22,18.625\"\n              {...props}\n            />\n          );\n\n        default:\n          return (\n            <path\n              d=\"M30,23.75A16 16 0 0 1 16 32A16 16 0 0 1 16 0A16 16 0 0 1 30 8.25A16 16 0 0 0 30,23.75\"\n              {...props}\n            />\n          );\n      }\n\n    default:\n      switch (photoSize) {\n        case 16:\n          return (\n            <path\n              d=\"M2,13.285A8 8 0 0 0 8 16A8 8 0 0 0 8 0A8 8 0 0 0 2 2.715A8 8 0 0 1 2,13.285\"\n              {...props}\n            />\n          );\n        case 24:\n          return (\n            <path\n              d=\"M2,18.625A12 12 0 0 0 12 24A12 12 0 0 0 12 0A12 12 0 0 0 2 5.375A12 12 0 0 1 2,18.625\"\n              {...props}\n            />\n          );\n\n        default:\n          return (\n            <path\n              d=\"M2,23.75A16 16 0 0 0 16 32A16 16 0 0 0 16 0A16 16 0 0 0 2 8.25A16 16 0 0 1 2,23.75\"\n              {...props}\n            />\n          );\n      }\n  }\n}\n\nconst photoSizes: Record<NonNullable<UsersStackProps['size']>, PhotoSizeType> = {\n  s: 16,\n  m: 24,\n  l: 32,\n};\n\nconst warn = warnOnce('UsersStack');\n\n/**\n * @see https://vkcom.github.io/VKUI/#/UsersStack\n */\nexport const UsersStack = ({\n  photos = [],\n  visibleCount = 3,\n  count = Math.max(0, photos.length - visibleCount),\n  size = 'm',\n  layout,\n  children,\n  className,\n  direction: directionProp = 'row',\n  ...restProps\n}: UsersStackProps) => {\n  const cmpId = useId();\n\n  const canShowOthers = count > 0 && count < 100 && size !== 's';\n  const CounterTypography = size === 'l' ? Footnote : Caption;\n\n  const photoSize = photoSizes[size];\n  const directionClip = canShowOthers ? 'right' : 'left';\n\n  const photosElements = photos.slice(0, visibleCount).map((photo, i) => {\n    const direction = i === 0 && !canShowOthers ? 'circle' : directionClip;\n\n    const id = `UsersStackDefs${cmpId}${i}`;\n    const hrefID = `#${id}`;\n    const maskID = `UsersStackMask${cmpId}${i}`;\n\n    return (\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        className={styles['UsersStack__photo']}\n        key={i}\n        aria-hidden\n      >\n        <defs>\n          <PathElement id={id} direction={direction} photoSize={photoSize} />\n        </defs>\n        <clipPath id={maskID}>\n          <use href={hrefID} />\n        </clipPath>\n        <g clipPath={`url(#${maskID})`}>\n          <use href={hrefID} className={styles['UsersStack__fill']} />\n          <image href={photo} width={photoSize} height={photoSize} />\n          <use href={hrefID} fill=\"none\" stroke=\"rgba(0, 0, 0, 0.08)\" />\n        </g>\n      </svg>\n    );\n  });\n\n  const othersElement = canShowOthers ? (\n    <CounterTypography\n      caps\n      weight=\"1\"\n      className={classNames(styles['UsersStack__photo'], styles['UsersStack__photo--others'])}\n    >\n      +{count}\n    </CounterTypography>\n  ) : null;\n\n  if (process.env.NODE_ENV === 'development' && layout) {\n    // TODO [>=6]: Удалить layout\n    warn('Свойство \"layout\" будет удалено в v6. Используйте свойство \"direction\"');\n  }\n\n  const direction = (layout && (layout === 'vertical' ? 'column' : 'row')) || directionProp;\n\n  return (\n    <div\n      {...restProps}\n      className={classNames(\n        'vkuiInternalUsersStack',\n        styles['UsersStack'],\n        {\n          s: styles['UsersStack--size-s'],\n          m: styles['UsersStack--size-m'],\n          l: styles['UsersStack--size-l'],\n        }[size],\n        {\n          'row': styles['UsersStack--direction-row'],\n          'row-reverse': styles['UsersStack--direction-row-reverse'],\n          'column': styles['UsersStack--direction-column'],\n        }[direction],\n        className,\n      )}\n    >\n      {(photosElements.length > 0 || othersElement) && (\n        <div className={styles['UsersStack__photos']} aria-hidden>\n          {photosElements}\n          {othersElement}\n        </div>\n      )}\n      {hasReactNode(children) && (\n        <Footnote className={styles['UsersStack__text']}>{children}</Footnote>\n      )}\n    </div>\n  );\n};\n"],"names":["UsersStack","PathElement","photoSize","direction","props","radius","circle","cx","cy","r","path","d","photoSizes","s","m","l","warn","warnOnce","photos","visibleCount","count","Math","max","length","size","layout","children","className","directionProp","restProps","cmpId","useId","canShowOthers","CounterTypography","Footnote","Caption","directionClip","photosElements","slice","map","photo","i","id","hrefID","maskID","svg","xmlns","key","aria-hidden","defs","clipPath","use","href","g","image","width","height","fill","stroke","othersElement","caps","weight","classNames","process","env","NODE_ENV","div","hasReactNode"],"mappings":"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"}