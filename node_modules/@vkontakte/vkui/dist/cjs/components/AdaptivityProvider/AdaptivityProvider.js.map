{"version":3,"sources":["../../../../src/components/AdaptivityProvider/AdaptivityProvider.tsx"],"sourcesContent":["import * as React from 'react';\nimport { hasMouse as _hasPointer } from '@vkontakte/vkjs';\nimport { BridgeAdaptivity, useBridgeAdaptivity } from '../../hooks/useBridgeAdaptivity';\nimport { BREAKPOINTS, SizeType, ViewHeight, ViewWidth } from '../../lib/adaptivity';\nimport { HasChildren } from '../../types';\nimport { AdaptivityContext, type AdaptivityProps } from './AdaptivityContext';\n\nexport interface AdaptivityProviderProps extends AdaptivityProps, HasChildren {}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/AdaptivityProvider\n */\nexport const AdaptivityProvider = ({\n  viewWidth,\n  viewHeight,\n  sizeX,\n  sizeY,\n  hasPointer,\n  hasHover,\n  children,\n}: AdaptivityProviderProps) => {\n  const bridge = useBridgeAdaptivity();\n  const adaptivity = React.useMemo(\n    () =>\n      calculateAdaptivity(\n        {\n          viewWidth,\n          viewHeight,\n          sizeX,\n          sizeY,\n          hasPointer,\n          hasHover,\n        },\n        bridge,\n      ),\n    [viewWidth, viewHeight, sizeX, sizeY, hasPointer, hasHover, bridge],\n  );\n\n  return <AdaptivityContext.Provider value={adaptivity}>{children}</AdaptivityContext.Provider>;\n};\n\nfunction calculateAdaptivity(\n  { viewWidth, viewHeight, sizeX, sizeY, hasPointer, hasHover }: AdaptivityProps,\n  bridge: BridgeAdaptivity,\n) {\n  if (bridge.type === 'adaptive') {\n    const { viewportWidth, viewportHeight } = bridge;\n\n    if (viewportWidth >= BREAKPOINTS.DESKTOP) {\n      viewWidth = ViewWidth.DESKTOP;\n    } else if (viewportWidth >= BREAKPOINTS.TABLET) {\n      viewWidth = ViewWidth.TABLET;\n    } else if (viewportWidth >= BREAKPOINTS.SMALL_TABLET) {\n      viewWidth = ViewWidth.SMALL_TABLET;\n    } else if (viewportWidth >= BREAKPOINTS.MOBILE) {\n      viewWidth = ViewWidth.MOBILE;\n    } else {\n      viewWidth = ViewWidth.SMALL_MOBILE;\n    }\n\n    if (viewportHeight >= BREAKPOINTS.MEDIUM_HEIGHT) {\n      viewHeight = ViewHeight.MEDIUM;\n    } else if (viewportHeight >= BREAKPOINTS.MOBILE_LANDSCAPE_HEIGHT) {\n      viewHeight = ViewHeight.SMALL;\n    } else {\n      viewHeight = ViewHeight.EXTRA_SMALL;\n    }\n\n    if (viewWidth <= ViewWidth.MOBILE) {\n      sizeX = SizeType.COMPACT;\n    } else {\n      sizeX = SizeType.REGULAR;\n    }\n\n    if (\n      (viewWidth >= ViewWidth.SMALL_TABLET && _hasPointer) ||\n      viewHeight <= ViewHeight.EXTRA_SMALL\n    ) {\n      sizeY = SizeType.COMPACT;\n    } else {\n      sizeY = SizeType.REGULAR;\n    }\n  } else if (bridge.type === 'force_mobile' || bridge.type === 'force_mobile_compact') {\n    viewWidth = ViewWidth.MOBILE;\n    sizeX = SizeType.COMPACT;\n\n    if (bridge.type === 'force_mobile_compact') {\n      sizeY = SizeType.COMPACT;\n    } else {\n      sizeY = SizeType.REGULAR;\n    }\n  } else {\n    if (sizeX === undefined && viewWidth !== undefined) {\n      if (viewWidth <= ViewWidth.MOBILE) {\n        sizeX = SizeType.COMPACT;\n      } else {\n        sizeX = SizeType.REGULAR;\n      }\n    }\n    if (sizeY === undefined && viewWidth !== undefined && viewHeight !== undefined) {\n      if (\n        (viewWidth >= ViewWidth.SMALL_TABLET && _hasPointer) ||\n        viewHeight <= ViewHeight.EXTRA_SMALL\n      ) {\n        sizeY = SizeType.COMPACT;\n      } else {\n        sizeY = SizeType.REGULAR;\n      }\n    }\n  }\n\n  return {\n    viewWidth,\n    viewHeight,\n    sizeX,\n    sizeY,\n    hasPointer,\n    hasHover,\n  };\n}\n"],"names":["AdaptivityProvider","viewWidth","viewHeight","sizeX","sizeY","hasPointer","hasHover","children","bridge","useBridgeAdaptivity","adaptivity","React","useMemo","calculateAdaptivity","AdaptivityContext","Provider","value","type","viewportWidth","viewportHeight","BREAKPOINTS","DESKTOP","ViewWidth","TABLET","SMALL_TABLET","MOBILE","SMALL_MOBILE","MEDIUM_HEIGHT","ViewHeight","MEDIUM","MOBILE_LANDSCAPE_HEIGHT","SMALL","EXTRA_SMALL","SizeType","COMPACT","REGULAR","_hasPointer","undefined"],"mappings":"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"}